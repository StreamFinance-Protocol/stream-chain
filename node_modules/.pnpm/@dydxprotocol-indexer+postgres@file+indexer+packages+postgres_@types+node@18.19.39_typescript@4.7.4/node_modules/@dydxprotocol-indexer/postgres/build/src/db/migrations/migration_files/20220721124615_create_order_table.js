"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.down = exports.up = void 0;
async function up(knex) {
    return knex
        .schema
        .createTable('orders', (table) => {
        table.uuid('id').primary();
        table.uuid('subaccountId').notNullable();
        table.bigInteger('clientId').notNullable();
        table.bigInteger('clobPairId').notNullable();
        table.enum('side', [
            'BUY',
            'SELL',
        ]).notNullable();
        table.decimal('size', null).notNullable();
        table.decimal('totalFilled', null).notNullable();
        table.decimal('price', null).notNullable();
        table.enum('type', [
            'LIMIT',
            'MARKET',
            'STOP_LIMIT',
            'STOP_MARKET',
            'TRAILING_STOP',
            'TAKE_PROFIT',
            'TAKE_PROFIT_MARKET',
            'LIQUIDATED',
            'LIQUIDATION',
            'HARD_TRADE',
            'FAILED_HARD_TRADE',
            'TRANSFER_PLACEHOLDER',
        ]).notNullable();
        table.enum('status', [
            'OPEN',
            'FILLED',
            'CANCELED',
            'BEST_EFFORT_CANCELED',
        ]).notNullable();
        table.enum('timeInForce', [
            'GTT',
            'FOK',
            'IOC',
            'POST_ONLY',
        ]).notNullable();
        table.boolean('reduceOnly').notNullable();
        // `orderFlags` indicate the type of the order on the protocol, and is one of the fields that
        // is used to generate the order UUID.
        table.bigInteger('orderFlags').notNullable();
        // One of `goodTilBlock` or `goodTilBlockTime` must be set, but not both. This is enforced
        // by a CHECK constraint in a later migration (20230201173734).
        table.bigInteger('goodTilBlock').nullable();
        table.timestamp('goodTilBlockTime').nullable();
        table.bigInteger('createdAtHeight').nullable();
        table.bigInteger('clientMetadata').notNullable();
        // Foreign
        table.foreign('subaccountId').references('subaccounts.id');
        // Indices
        table.index(['subaccountId']);
        table.index(['clobPairId', 'side', 'price']);
    });
}
exports.up = up;
async function down(knex) {
    return knex.schema.dropTableIfExists('orders');
}
exports.down = down;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjAyMjA3MjExMjQ2MTVfY3JlYXRlX29yZGVyX3RhYmxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2RiL21pZ3JhdGlvbnMvbWlncmF0aW9uX2ZpbGVzLzIwMjIwNzIxMTI0NjE1X2NyZWF0ZV9vcmRlcl90YWJsZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFFTyxLQUFLLFVBQVUsRUFBRSxDQUFDLElBQVU7SUFDakMsT0FBTyxJQUFJO1NBQ1IsTUFBTTtTQUNOLFdBQVcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxLQUFLLEVBQUUsRUFBRTtRQUMvQixLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQzNCLEtBQUssQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDekMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUMzQyxLQUFLLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzdDLEtBQUssQ0FBQyxJQUFJLENBQ1IsTUFBTSxFQUNOO1lBQ0UsS0FBSztZQUNMLE1BQU07U0FDUCxDQUNGLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDaEIsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDMUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxhQUFhLEVBQUUsSUFBSSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDakQsS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDM0MsS0FBSyxDQUFDLElBQUksQ0FDUixNQUFNLEVBQ047WUFDRSxPQUFPO1lBQ1AsUUFBUTtZQUNSLFlBQVk7WUFDWixhQUFhO1lBQ2IsZUFBZTtZQUNmLGFBQWE7WUFDYixvQkFBb0I7WUFDcEIsWUFBWTtZQUNaLGFBQWE7WUFDYixZQUFZO1lBQ1osbUJBQW1CO1lBQ25CLHNCQUFzQjtTQUN2QixDQUNGLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDaEIsS0FBSyxDQUFDLElBQUksQ0FDUixRQUFRLEVBQ1I7WUFDRSxNQUFNO1lBQ04sUUFBUTtZQUNSLFVBQVU7WUFDVixzQkFBc0I7U0FDdkIsQ0FDRixDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ2hCLEtBQUssQ0FBQyxJQUFJLENBQ1IsYUFBYSxFQUNiO1lBQ0UsS0FBSztZQUNMLEtBQUs7WUFDTCxLQUFLO1lBQ0wsV0FBVztTQUNaLENBQ0YsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNoQixLQUFLLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzFDLDZGQUE2RjtRQUM3RixzQ0FBc0M7UUFDdEMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUM3QywwRkFBMEY7UUFDMUYsK0RBQStEO1FBQy9ELEtBQUssQ0FBQyxVQUFVLENBQUMsY0FBYyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDNUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQy9DLEtBQUssQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUMvQyxLQUFLLENBQUMsVUFBVSxDQUFDLGdCQUFnQixDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFFakQsVUFBVTtRQUNWLEtBQUssQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDLENBQUMsVUFBVSxDQUFDLGdCQUFnQixDQUFDLENBQUM7UUFFM0QsVUFBVTtRQUNWLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDO1FBQzlCLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxZQUFZLEVBQUUsTUFBTSxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUM7SUFDL0MsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDO0FBdkVELGdCQXVFQztBQUVNLEtBQUssVUFBVSxJQUFJLENBQUMsSUFBVTtJQUNuQyxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDakQsQ0FBQztBQUZELG9CQUVDIn0=