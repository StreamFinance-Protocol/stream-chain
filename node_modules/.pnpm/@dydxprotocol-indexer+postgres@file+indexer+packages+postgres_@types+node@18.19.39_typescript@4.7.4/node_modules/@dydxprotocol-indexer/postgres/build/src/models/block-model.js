"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const path_1 = __importDefault(require("path"));
const objection_1 = require("objection");
const validators_1 = require("../lib/validators");
class BlockModel extends objection_1.Model {
    static get tableName() {
        return 'blocks';
    }
    static get idColumn() {
        return 'blockHeight';
    }
    static get jsonSchema() {
        return {
            type: 'object',
            required: [
                'blockHeight',
                'time',
            ],
            properties: {
                blockHeight: { type: 'string', pattern: validators_1.IntegerPattern },
                time: { type: 'string', format: 'date-time' },
            },
        };
    }
}
exports.default = BlockModel;
BlockModel.relationMappings = {
    fills: {
        relation: objection_1.Model.HasManyRelation,
        modelClass: path_1.default.join(__dirname, 'fill-model'),
        join: {
            from: 'blocks.blockHeight',
            to: 'fills.createdAtHeight',
        },
    },
    transfers: {
        relation: objection_1.Model.HasManyRelation,
        modelClass: path_1.default.join(__dirname, 'transfer-model'),
        join: {
            from: 'blocks.blockHeight',
            to: 'transfers.createdAtHeight',
        },
    },
    tendermintEvents: {
        relation: objection_1.Model.HasManyRelation,
        modelClass: path_1.default.join(__dirname, 'tendermint-event-model'),
        join: {
            from: 'blocks.blockHeight',
            to: 'tendermint_events.blockHeight',
        },
    },
    oraclePrices: {
        relation: objection_1.Model.HasManyRelation,
        modelClass: path_1.default.join(__dirname, 'oracle-price-model'),
        join: {
            from: 'blocks.blockHeight',
            to: 'oracle_prices.effectiveAtHeight',
        },
    },
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmxvY2stbW9kZWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvbW9kZWxzL2Jsb2NrLW1vZGVsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsZ0RBQXdCO0FBRXhCLHlDQUFrQztBQUVsQyxrREFBbUQ7QUFHbkQsTUFBcUIsVUFBVyxTQUFRLGlCQUFLO0lBQzNDLE1BQU0sS0FBSyxTQUFTO1FBQ2xCLE9BQU8sUUFBUSxDQUFDO0lBQ2xCLENBQUM7SUFFRCxNQUFNLEtBQUssUUFBUTtRQUNqQixPQUFPLGFBQWEsQ0FBQztJQUN2QixDQUFDO0lBcUNELE1BQU0sS0FBSyxVQUFVO1FBQ25CLE9BQU87WUFDTCxJQUFJLEVBQUUsUUFBUTtZQUNkLFFBQVEsRUFBRTtnQkFDUixhQUFhO2dCQUNiLE1BQU07YUFDUDtZQUNELFVBQVUsRUFBRTtnQkFDVixXQUFXLEVBQUUsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSwyQkFBYyxFQUFFO2dCQUN4RCxJQUFJLEVBQUUsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUU7YUFDOUM7U0FDRixDQUFDO0lBQ0osQ0FBQzs7QUF4REgsNkJBNkRDO0FBcERRLDJCQUFnQixHQUFHO0lBQ3hCLEtBQUssRUFBRTtRQUNMLFFBQVEsRUFBRSxpQkFBSyxDQUFDLGVBQWU7UUFDL0IsVUFBVSxFQUFFLGNBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFlBQVksQ0FBQztRQUM5QyxJQUFJLEVBQUU7WUFDSixJQUFJLEVBQUUsb0JBQW9CO1lBQzFCLEVBQUUsRUFBRSx1QkFBdUI7U0FDNUI7S0FDRjtJQUNELFNBQVMsRUFBRTtRQUNULFFBQVEsRUFBRSxpQkFBSyxDQUFDLGVBQWU7UUFDL0IsVUFBVSxFQUFFLGNBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLGdCQUFnQixDQUFDO1FBQ2xELElBQUksRUFBRTtZQUNKLElBQUksRUFBRSxvQkFBb0I7WUFDMUIsRUFBRSxFQUFFLDJCQUEyQjtTQUNoQztLQUNGO0lBQ0QsZ0JBQWdCLEVBQUU7UUFDaEIsUUFBUSxFQUFFLGlCQUFLLENBQUMsZUFBZTtRQUMvQixVQUFVLEVBQUUsY0FBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsd0JBQXdCLENBQUM7UUFDMUQsSUFBSSxFQUFFO1lBQ0osSUFBSSxFQUFFLG9CQUFvQjtZQUMxQixFQUFFLEVBQUUsK0JBQStCO1NBQ3BDO0tBQ0Y7SUFDRCxZQUFZLEVBQUU7UUFDWixRQUFRLEVBQUUsaUJBQUssQ0FBQyxlQUFlO1FBQy9CLFVBQVUsRUFBRSxjQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxvQkFBb0IsQ0FBQztRQUN0RCxJQUFJLEVBQUU7WUFDSixJQUFJLEVBQUUsb0JBQW9CO1lBQzFCLEVBQUUsRUFBRSxpQ0FBaUM7U0FDdEM7S0FDRjtDQUNGLENBQUMifQ==