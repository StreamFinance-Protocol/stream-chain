"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.down = exports.up = void 0;
async function up(knex) {
    return knex
        .schema
        .createTable('oracle_prices', (table) => {
        table.uuid('id').primary();
        table.integer('marketId').notNullable();
        table.decimal('price', null).notNullable();
        table.timestamp('effectiveAt').notNullable();
        table.bigInteger('effectiveAtHeight').notNullable();
        // Foreign
        table.foreign('marketId').references('markets.id');
        table.foreign('effectiveAtHeight').references('blocks.blockHeight');
        // Indices
        table.index(['marketId', 'effectiveAt']);
        table.index(['marketId']);
    });
}
exports.up = up;
async function down(knex) {
    return knex.schema.dropTableIfExists('oracle_prices');
}
exports.down = down;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjAyMzAxMTMxNjU3MDNfY3JlYXRlX29yYWNsZV9wcmljZV90YWJsZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9kYi9taWdyYXRpb25zL21pZ3JhdGlvbl9maWxlcy8yMDIzMDExMzE2NTcwM19jcmVhdGVfb3JhY2xlX3ByaWNlX3RhYmxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUVPLEtBQUssVUFBVSxFQUFFLENBQUMsSUFBVTtJQUNqQyxPQUFPLElBQUk7U0FDUixNQUFNO1NBQ04sV0FBVyxDQUFDLGVBQWUsRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO1FBQ3RDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDM0IsS0FBSyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUN4QyxLQUFLLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUMzQyxLQUFLLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzdDLEtBQUssQ0FBQyxVQUFVLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUVwRCxVQUFVO1FBQ1YsS0FBSyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDbkQsS0FBSyxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1FBRXBFLFVBQVU7UUFDVixLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsVUFBVSxFQUFFLGFBQWEsQ0FBQyxDQUFDLENBQUM7UUFDekMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7SUFDNUIsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDO0FBbEJELGdCQWtCQztBQUVNLEtBQUssVUFBVSxJQUFJLENBQUMsSUFBVTtJQUNuQyxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsZUFBZSxDQUFDLENBQUM7QUFDeEQsQ0FBQztBQUZELG9CQUVDIn0=