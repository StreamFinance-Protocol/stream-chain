"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.down = exports.up = void 0;
async function up(knex) {
    return knex
        .schema
        .createTable('funding_index_updates', (table) => {
        table.uuid('id').primary();
        table.bigInteger('perpetualId').notNullable();
        table.binary('eventId', 96).notNullable();
        table.decimal('rate', null).notNullable();
        table.decimal('oraclePrice', null).notNullable();
        table.decimal('fundingIndex', null).notNullable();
        table.timestamp('effectiveAt').notNullable();
        table.bigInteger('effectiveAtHeight').notNullable();
        // Foreign
        table.foreign('eventId').references('tendermint_events.id');
        table.foreign('perpetualId').references('perpetual_markets.id');
        table.foreign('effectiveAtHeight').references('blocks.blockHeight');
        // Indices
        table.index(['perpetualId']);
        table.index(['effectiveAtHeight']);
    });
}
exports.up = up;
async function down(knex) {
    return knex.schema.dropTableIfExists('funding_index_updates');
}
exports.down = down;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjAyMzA0MTgxMzI0NDFfY3JlYXRlX2Z1bmRpbmdfaW5kZXhfdXBkYXRlc190YWJsZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9kYi9taWdyYXRpb25zL21pZ3JhdGlvbl9maWxlcy8yMDIzMDQxODEzMjQ0MV9jcmVhdGVfZnVuZGluZ19pbmRleF91cGRhdGVzX3RhYmxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUVPLEtBQUssVUFBVSxFQUFFLENBQUMsSUFBVTtJQUNqQyxPQUFPLElBQUk7U0FDUixNQUFNO1NBQ04sV0FBVyxDQUFDLHVCQUF1QixFQUFFLENBQUMsS0FBSyxFQUFFLEVBQUU7UUFDOUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUMzQixLQUFLLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzlDLEtBQUssQ0FBQyxNQUFNLENBQUMsU0FBUyxFQUFFLEVBQUUsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzFDLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzFDLEtBQUssQ0FBQyxPQUFPLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ2pELEtBQUssQ0FBQyxPQUFPLENBQUMsY0FBYyxFQUFFLElBQUksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ2xELEtBQUssQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDN0MsS0FBSyxDQUFDLFVBQVUsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBRXBELFVBQVU7UUFDVixLQUFLLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO1FBQzVELEtBQUssQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUMsVUFBVSxDQUFDLHNCQUFzQixDQUFDLENBQUM7UUFDaEUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO1FBRXBFLFVBQVU7UUFDVixLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQztRQUM3QixLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDO0lBQ3JDLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQztBQXRCRCxnQkFzQkM7QUFFTSxLQUFLLFVBQVUsSUFBSSxDQUFDLElBQVU7SUFDbkMsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLHVCQUF1QixDQUFDLENBQUM7QUFDaEUsQ0FBQztBQUZELG9CQUVDIn0=