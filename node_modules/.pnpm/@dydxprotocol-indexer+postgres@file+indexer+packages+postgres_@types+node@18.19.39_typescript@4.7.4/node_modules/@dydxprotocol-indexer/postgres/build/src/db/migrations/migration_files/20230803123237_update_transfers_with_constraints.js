"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.down = exports.up = void 0;
// Add a constraint to the `orders` table to ensure that one of `goodTilBlock` and
// `goodTilBlockTime` is non-null for each row, but not both.
async function up(knex) {
    return knex
        .schema
        .raw(`
      ALTER TABLE "transfers" ADD CONSTRAINT recipient_non_null CHECK (num_nonnulls("recipientWalletAddress", "recipientSubaccountId") = 1);
    `).raw(`
      ALTER TABLE "transfers" ADD CONSTRAINT sender_non_null CHECK (num_nonnulls("senderWalletAddress", "senderSubaccountId") = 1);
    `);
}
exports.up = up;
async function down(knex) {
    return knex
        .schema
        .raw(`
      ALTER TABLE "transfers" DROP CONSTRAINT recipient_non_null;
    `)
        .raw(`
      ALTER TABLE "transfers" DROP CONSTRAINT sender_non_null;
    `);
}
exports.down = down;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjAyMzA4MDMxMjMyMzdfdXBkYXRlX3RyYW5zZmVyc193aXRoX2NvbnN0cmFpbnRzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2RiL21pZ3JhdGlvbnMvbWlncmF0aW9uX2ZpbGVzLzIwMjMwODAzMTIzMjM3X3VwZGF0ZV90cmFuc2ZlcnNfd2l0aF9jb25zdHJhaW50cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFFQSxrRkFBa0Y7QUFDbEYsNkRBQTZEO0FBQ3RELEtBQUssVUFBVSxFQUFFLENBQUMsSUFBVTtJQUNqQyxPQUFPLElBQUk7U0FDUixNQUFNO1NBQ04sR0FBRyxDQUFDOztLQUVKLENBQUMsQ0FBQyxHQUFHLENBQUM7O0tBRU4sQ0FBQyxDQUFDO0FBQ1AsQ0FBQztBQVJELGdCQVFDO0FBRU0sS0FBSyxVQUFVLElBQUksQ0FBQyxJQUFVO0lBQ25DLE9BQU8sSUFBSTtTQUNSLE1BQU07U0FDTixHQUFHLENBQUM7O0tBRUosQ0FBQztTQUNELEdBQUcsQ0FBQzs7S0FFSixDQUFDLENBQUM7QUFDUCxDQUFDO0FBVEQsb0JBU0MifQ==