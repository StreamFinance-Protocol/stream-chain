"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.down = exports.up = void 0;
async function up(knex) {
    return knex
        .schema
        .createTable('pnl_ticks', (table) => {
        table.uuid('id').primary();
        table.uuid('subaccountId').notNullable();
        table.decimal('equity', null).notNullable();
        table.decimal('totalPnl', null).notNullable();
        table.decimal('netTransfers', null).notNullable();
        table.timestamp('createdAt').notNullable();
        table.bigInteger('blockHeight').notNullable();
        table.timestamp('blockTime').notNullable();
        // Foreign
        table.foreign('subaccountId').references('subaccounts.id');
        table.foreign(['blockHeight', 'blockTime']).references(['blocks.blockHeight', 'blocks.time']);
        // Indices
        table.index(['subaccountId', 'createdAt']);
        table.index(['createdAt']);
    });
}
exports.up = up;
async function down(knex) {
    return knex.schema.dropTableIfExists('pnl_ticks');
}
exports.down = down;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMjAyMzA0MDQxMjQzNTNfY3JlYXRlX3BubF90aWNrc190YWJsZS50cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9kYi9taWdyYXRpb25zL21pZ3JhdGlvbl9maWxlcy8yMDIzMDQwNDEyNDM1M19jcmVhdGVfcG5sX3RpY2tzX3RhYmxlLnRzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUVPLEtBQUssVUFBVSxFQUFFLENBQUMsSUFBVTtJQUNqQyxPQUFPLElBQUk7U0FDUixNQUFNO1NBQ04sV0FBVyxDQUFDLFdBQVcsRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO1FBQ2xDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDM0IsS0FBSyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUN6QyxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUM1QyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUM5QyxLQUFLLENBQUMsT0FBTyxDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNsRCxLQUFLLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzNDLEtBQUssQ0FBQyxVQUFVLENBQUMsYUFBYSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDOUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUUzQyxVQUFVO1FBQ1YsS0FBSyxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQyxVQUFVLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUMzRCxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsYUFBYSxFQUFFLFdBQVcsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsb0JBQW9CLEVBQUUsYUFBYSxDQUFDLENBQUMsQ0FBQztRQUU5RixVQUFVO1FBQ1YsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLGNBQWMsRUFBRSxXQUFXLENBQUMsQ0FBQyxDQUFDO1FBQzNDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0lBQzdCLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQztBQXJCRCxnQkFxQkM7QUFFTSxLQUFLLFVBQVUsSUFBSSxDQUFDLElBQVU7SUFDbkMsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBQ3BELENBQUM7QUFGRCxvQkFFQyJ9